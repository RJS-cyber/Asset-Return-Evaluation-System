@startuml ARES_Architecture_Diagram

skinparam packageStyle rectangle
skinparam defaultTextAlignment center

' Define colors for better visualization
skinparam package {
    BackgroundColor<<frontend>> LightBlue
    BackgroundColor<<backend>> LightGreen
    BorderColor Black
    FontSize 12
}

skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}

' ==================== FRONTEND PACKAGE ====================
package "Frontend" <<frontend>> {

    rectangle HTML
    rectangle CSS
    rectangle JavaScript

    ' Frontend internal connections
    CSS --> HTML : "styles"
    HTML --> JavaScript : "uses"
}

' ==================== DTOs (Between Frontend and Backend) ====================
package "dto" {
    rectangle SendData [
        SendData
        ....
        - years: int
        - amount: double
        - assetTypes: ArrayList~AssetType~
        ....
        + getter
    ]

    rectangle ResponseData [
        ResponseData
        ....
        - resultsArray: Result[][]
        - maxYears: int
        - maxCapital: double
        - assetTypes: List~String~
        ....
        + getter
    ]
}

' ==================== BACKEND PACKAGE ====================
package "Backend" <<backend>> {

    ' Application Entry Point
    rectangle Application [
        <<SpringBootApplication>>
        Application
        ....
        + main(String[]): void
    ]

    ' AssetType Enum
    rectangle AssetType [
        <<enumeration>>
        AssetType
        ....
        BONDS(typeId "Bonds", indexId 0)
        RAW_MATERIALS(typeId "Raw-Materials", indexId 1)
        REAL_ESTATES(typeId "Real-Estates", indexId 2)
        STOCKS(typeId "Stocks", indexId 3)
        ....
        - typeId: String
        - indexId: int
        ....
        + getTypeId(): String
        + getIndexId(): int
    ]

    ' Controller Layer
    rectangle Controller [
        Controller
        ....
        - service: Service
        ....
        + calculate(@RequestBody SendData): ResponseEntity~ResponseData~
    ]

    ' Service Layer
    rectangle Service [
        Service
        ....
        - repository: Repository
        - random: Random
        ....
        + storeData(int, double, AssetType): void
        + simulation(): void
        + getResults(): Result[]
        + graphDataYears(): int
        + graphDataMaxCapital(): double
        - createAssetByType(AssetType, double, int): Asset
        - calculation(Result, Asset, int, Random): Result
    ]

    ' Repository Layer
    rectangle Repository [
        Repository
        ....
        - assets: ArrayList~Asset~
        - resultsMap: Map~Integer, Map~AssetType, Result~~
        ....
        + addAsset(Asset): void
        + storeResult(Result): void
        + clearRepo(): void
        + getResultForYearAndType(int, AssetType): Result
        + getResultsAsArray(): Result[][]
        + getAllResultsRaw(): Map~Integer, Map~AssetType, Result~~
        + getMaxCapital(): double
        - getResultsForYear(int): Map~AssetType, Result~
        - amountOfTypes(): int
    ]

    ' Model Package
    package "model" {
        rectangle Asset [
            <<abstract>>
            Asset
            ....
            - type: AssetType
            - startcapital: double
            - years: int
            - interest: float
            - volatility: float
            ....
            + getType(): AssetType
            + getStartcapital(): double
            + getYears(): int
            + getInterest(): float
            + getVolatility(): float
        ]

        rectangle Bonds [
            Bonds
            ....
            + Bonds(double, int)
        ]

        rectangle Stocks [
            Stocks
            ....
            + Stocks(double, int)
        ]

        rectangle RawMaterials [
            RawMaterials
            ....
            + RawMaterials(double, int)
        ]

        rectangle RealEstates [
            RealEstates
            ....
            + RealEstates(double startcapital, int years)
        ]

        rectangle Result [
            <<record>>
            Result
            ....
            - type: AssetType
            - year: int
            - capital: double
            - development: double
            ....
            + Result(AssetType, int, double, double)
            + type(): AssetType
            + year(): int
            + capital(): double
            + development(): double
        ]

        ' Inheritance relationships
        Asset <|-- Bonds
        Asset <|-- Stocks
        Asset <|-- RawMaterials
        Asset <|-- RealEstates
    }

    ' Backend internal relationships
    Application --> Service : "starts/initializes"

    Controller --> Service : "uses"

    Service --> Repository : "uses"
    Service --> Asset : "creates"
    Service --> Result : "creates"
    Service --> AssetType : "uses"

    Repository --> Asset : "stores"
    Repository --> Result : "stores in\nresultsMap"
    Repository --> Result : "returns as\nResult[]"

    Asset --> AssetType : "has type"
    Result --> AssetType : "has type"
}

' ==================== FRONTEND-BACKEND COMMUNICATION ====================
JavaScript -[#blue,bold]-> SendData : "prepares data"
SendData -[#blue,bold]-> Controller : "POST /api/ares/calculate"
Controller -[#blue,bold]-> ResponseData : "returns"
ResponseData -[#blue,bold]-> JavaScript : "receives data"

' Legend
legend right
    |= Component |= Description |
    | **Frontend** | HTML pages with CSS and JS |
    | **Backend** | Spring Boot REST API |
    | **Controller** | REST endpoints for communication |
    | **Service** | Business logic & Simulation |
    | **Repository** | Data storage |
    | **DTOs** | Data Transfer Objects |
    | **Model** | Data Carrier |
endlegend

@enduml
